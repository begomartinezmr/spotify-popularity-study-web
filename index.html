<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Pop Predictor</title>
		 <link rel="icon" href="imgs/logo.png" type="image/png">
        <link rel="stylesheet" href="css/bootstrap.min.css">
        <link rel="stylesheet" href="css/style.css">
        <link rel="stylesheet" href="css/fontawesome.min.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans|Roboto" rel="stylesheet">
    </head>
    <body>
        
        <nav class="navbar navbar-expand-lg navbar-light text-capitalize">
            <div class="container">
                <a class="navbar-brand" href="#"><img src="imgs/logo.png" alt="#" width="50" height="50"/></a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#show-menu" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="show-menu">
                    <ul class="navbar-nav ml-auto">
                        <li class="nav-item active">
                            <a class="nav-link" href="#home">Inicio <span class="sr-only">(current)</span></a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#project-description">Proyecto</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#model">Modelo y Datos</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#application">Aplicación</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#results">Resultado</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#performance">Rendimiento</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#about">Sobre Nosotros</a>
                        </li>
                        
                    </ul>
                </div>
            </div>
        </nav>
        
        <header id="home">
            <div class="overlay">
                <div class="container">
                    <div>
                        <h1><span>Spotify Popularity Predictor</span><br></h1>
                        <p>Cloud & Big Data - Universidad Complutense de Madrid</p>
                        <button><a href="https://github.com/begomartinezmr/spotify-popularity-study" target="_blank" class="text-uppercase">GitHub</a></button>
                    </div>
                </div>
            </div>
        </header>
        <div class="project-description" id="project-description">
            <div class="small-container">
                <p></p>
                <p></p>
                <h2 class="text-center"><span> Descripción del Proyecto</span></h2>
                <div class="container">
                    <div class="row">
                        <p> 
                        La idea de la aplicación es predecir en streaming la popularidad de las canciones de las new_releases 
                        de Spotify. Para ello haremos uso de un modelo de regresión lineal previamente entrenado a partir de un 
                        <a href="https://www.kaggle.com/yamaerenay/spotify-dataset-19212020-160k-tracks">dataset que contine unas 160k canciones </a> 
                        que contienen diferentes parámetros y métricas de los distintos temas. </p>
                    </div>
                </div>
                <div class="first"></div>
                <div class="second"></div>
            </div>
        </div>
        <div class="big-data" id="big data">
            <div class="small-container">
                <h2 class="text-center">Necesidad de <span>Big Data</span></h2>
                <div class="container">
                    <div class="row">
                        <p> Necesitamos <span>Big Data</span> para poder almacenar y manejar tanto los datos iniciales como los futuros
                         que cogeremos de Spotify. </p>
                         <p> También necesitamos <span>Large Parallel Processing </span> para procesar los datos y entrenar al
                             modelo de aprendizaje supervisado que predice la popularidad de los nuevos lanzamientos. </p>
                    </div>
                </div>
                <div class="first"></div>
                <div class="second"></div>
            </div>
        </div>
        <div class="statistics text-capitalize text-center font-weight-bold">
            <div class="container">
                <div class="row">
                    <div class="col-lg-3 col-md-6 col-12">
                        <i class="fas fa-file-csv fa-3x"></i>
                        <h3>1</h3>
                        <p>Datasheet</p>
                    </div>
                    <div class="col-lg-3 col-md-6 col-12">
                        <i class="fas fa-music fa-3x"></i>
                        <h3>160K</h3>
                        <p>songs</p>
                    </div>
                    <div class="col-lg-3 col-md-6 col-12">
                        <i class="fab fa-spotify fa-3x"></i>
                        <h3>32</h3>
                        <p>albums</p>
                    </div>
                    <div class="col-lg-3 col-md-6 col-12">
                        <i class="fas fa-database fa-3x"></i>
                        <h3>16 MB</h3>
                        <p>of Data</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="model" id="model">
            <div class="small-container">
                <h2 class="text-center"><span>Modelo de Predicción & Datos</span></h2>
                <div class="container">
                    <div class="row">
                        <p> Para crear el modelo de predicción, partimos de un 
                            <a href="https://www.kaggle.com/yamaerenay/spotify-dataset-19212020-160k-tracks">dataset que contine unas 160k canciones </a>  
                            alojadas en Spotify cuyo año de publicación va desde 1921 hasta la actualidad. 
                            Cada canción viene descrita en el dataset por las siguientes variables: 
                            <span>id, name, artists, year, valence, acousticness, danceability, duration_ms, energy, 
                            explicit, instrumentalness, key, liveness, loudness, mode, popularity, release_date, speechiness y tempo.</span>
                            Podemos observar que se trata de una serie de variables y métricas muy heterogénes y quizá no todas sean relevantes para nuestro modelo de regresión. 
                            Por ello conviene relizar un estudio y limpieza previa del conjunto para conservar solo aquellas veriables útiles para el predictor.
                        </p>
                        <h4>Estudio y Limpieza</h4>
                        <p>
                            A grandes rasgos podemos diferenciar dos grandes tipos de columnas en el conjunto: 
                            las <span>variables no numéricas</span> (describen atributos de la pista como su nombre, artista, identificador) 
                            y las <span>variables numéricas</span> (describen diversas métricas del sonido, duración o incluso otros atributos como 
                            el año de lanzamiento). Para nuestro modelo de regresión, utilizaremos las <span>variables numéricas</span>. 
                            Es conveniente además conocer cuáles de estás métricas guardan un mayor grado de correlación con la variable a 
                            predecir ya que así nuestro modelo de regresión ofrecerá resultados más precisos y fiables que si utilizamos variables 
                            menos significativas.   
                        </p>
                        <div class="popularity_corr">
                            <img src="imgs/popularity_corr.png" class="d-block w-100" alt="Popularity correlation">
                        </div>
                        <p>
                            Observamos que con mucha diferencia la variable que más correlacionada está con la popularidad de una pista es, 
                            con diferencia <span>year</span>, seguida de otras que tambien lo están en manor medida como <span>energy, acousticness o loudness.</span> 
                            El resto de variables guardan un grado de correlación con la popularidad bastante residual, 
                            por lo que será conveniente descartarlos de cara a la construcción de nuestro modelo ya que quizá sean perjudiciales.
                        </p>
                        <h4>El modelo</h4>
                        <p>
                            Optamos finalmente por utilizar un modelo de regresión lineal múltiple para establecer una relación estadística entre las variables seleccionadas 
                            y la popularidad. En este caso hemos optado por utilizar el modelo 
                            <a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html">LinearRegression de scikit-learn</a>. 
                            Su funcionamiento es simple, genera el modelo con el metodo fit(x,y) a partir de una matriz de datos (cada fila describe una pista mediante las variables elegidas) 
                            y un vector de etiquetas que en nuestro caso contiene la popularidad de cada pista descrita en la matriz ya que esta es la variable 
                            objetivo. Una vez entrenado, podemos medir el error medio de sus predicciones comparandolas con las etiquetas originales. 
                            Con el modelo ya genereado, el método predict(x) devolverá las etiqutas que el modelo asocie a cada nueva pista descrita parámetro. 
                            Además, podemos usar el error medio del modelo para emitir nuestra predicción como un rango en vez de un único valor 
                            (predicción ± error_medio).
                        </p>
                        <h4>Modelos alternativos</h4>
                        <p>
                            Partiendo de un esquema similar en el que recibimos en streaming nuevas canciones, 
                            podemos proponer otros modelos alternativos con los que trabajar con los datos que 
                            no sean la prediccion de popularidad mediante regresión lineal que hemos implementado.
                        </p>
                        <h5>Clasificación binaria explicit mediante Regresión Logística</h5>
                        <p>En este modelo nos valemos de la libería nativa de Spark 
                            <a href="https://spark.apache.org/docs/2.0.0-preview/ml-guide.html">Spark-ML</a> , 
                            para construir y entrenar el modelo. Tratamos de predecir si una canción 
                            contiene contenido explícito (que no es recomendable para niños o lenguaje ofensivo) o no. 
                            Para ellos hemos utilizado las columnas <span>valence,year,acousticness y danceability </span>del dataset 
                            y la característica a predecir es explicit, las pruebas muestran en torno a un 75% de acierto.</p>
                        <h5>Clasificación binaria de la popularidad mediante redes neuronales</h5>
                        <p>
                            Para este modelo hemos empleado Scikit-Learn, hemos tranformado con ayuda de la función "popularidad", 
                            los valores de la polularidad que van del rango 0 a 100 en ceros o unos, en función de si este valor es 
                            mayor o menor que 30. De esta forma transformamos el problema de clasifación de 100 clases a 2 clases. 
                            Con este modelo se obtuvo un porcentaje de acierto en torno al 99%.
                        </p>
                        <h5>Support vector machines SVM con kernel "gaussiano"</h5>
                        <p>Hemos empleaso Scikit-Learn con este modelo y se pretende predecir la popularidad y clasificarla en 100 clases (0...100). 
                            Con este modelo se obtuvo un porcentaje de acierto en torno al 60%.</p>
                    </div>
                </div>
                <div class="first"></div>
                <div class="second"></div>
            </div>
        </div>
        <div class="application" id="application">
            <div class="small-container">
                <h2 class="text-center"><span>La Aplicación</span></h2>
                <div class="container">
                    <div class="row">
                        <p> 
                        La aplicación está basada en un modelo cliente-servidor comunicados a través de un socket TCP. 
                        La idea es tener un proceso conectado a la interfaz python de spotify (spotipy) para recibir los álbumes 
                        new_releases a través de ella y poder enviarlos al segundo proceso en formato csv para que este pueda realizar 
                        la predicción a traves del modelo de regresión. A continuación exponemos los detalles de ambos scripts:
                        </p>
                        <ul>
                            <li><span>spotify_releases</span> es el proceso que se conecta con la interfaz de spotify y 
                            recupera la información de las new_releases. Éste método recupera albumes enteros, 
                            por lo que el proceso debe encargarse de recuperar las pistas que conforman cada album. 
                            Una vez las recupera todas, las envía al proceso <span>spotify_processing</span> como una tabla de pistas con sus 
                            correspondiente atributos en formato csv. Cabe destacar que tan solo recuperaremos aquellos atributos que 
                            utiliza nuestro modelo de predicción que detallamos anteriormente.
                            </li>
                            <li><span>spotify_processing</span> es el proceso que conecta con <span>spotify_releases</span> para recibir
                            los nuevos albumes como tablas de pistas, las formatea adecuadamente y las pasa por el modelo de predicción. 
                            Antes de conectar con <span>spotify_releases</span>, el proceso crea y entrena el modelo a partir de los datos de spotify_model.csv.
                            </li>
                        </ul>
                        <h4>Spotipy</h4>
                        <p>
                            Spotipy es una interfaz python que ofrece Spotify a los desarrolladores para tener completo acceso a los datos que ofrece Spotify. 
                            Para poder utilizarla, se requiere un proceso previo de autenticación mediante un identificador del cliente y una clave secreta que 
                            se pueden pasar como argumento del objeto SpotifyClientCredentials() o colocarse como variables de entorno en que se ejecuta el 
                            proceso. Para obtener dichas claves se deben seguir los siguientes pasos:
                            <ol>
                                <li>Registar una cuenta de usuario ordinario de Spotify (o iniciar sesión en una previamente existente)</li>
                                <li>Entrar en la plataforma de <a href="https://developer.spotify.com/dashboard/">desarrolladores de Spotify</a></li>
                                <li>Seleccionar el botón Create an app y especificar un nombre y una descripción de la aplicación así como aceptar todos los términos de uso</li>
                                <li>Una vez creada la aplicación en el developer dashboard de spotify, tan solo tenemos que consultar las claves asociadas a ella</li>
                            </ol>

                        </p>
                    </div>
                </div>
                <div class="first"></div>
                <div class="second"></div>
            </div>
        </div>
        <div class="usage" id="usage">
            <div class="small-container">
                <h2 class="text-center"><span>¿Cómo se ejecuta?</span></h2>
                <div class="container">
                    <div class="row">
                        <p> 
                        Como ya detallamos en el anterior apartado La aplicación, 
                        el programa está formado por dos scripts de python comunicados a través de un socket, 
                        por lo que necesitaremos dos terminales en las que ejecutar cada uno de ellos. </p>
                        <ol>
                            <li>
                                <p>Primero ejecutamos el script spotify_releases.py como un script python ordinario 
                                (asumiendo que se cumplen los requisitos de autenticación de spotify detallados 
                                en el apartado anterior).</p>
                                <p>Terminal 1: $ python3 spotipy_releases.py</p>
                            </li>
                            <li>
                                <p>Cuando el primer proceso quede a la espera de una conexión TCP, 
                                lanzamos el script spotify_processing.py como un spark job.</p>
                                <p>Terminal 2: $ spark-submit spotify_processing.py</p>
                            </li>
                                
                        </ol>
                    </div>
                </div>
                <div class="first"></div>
                <div class="second"></div>
            </div>
        </div>
        <div class="results" id="results">
            <div class="small-container">
                <h2 class="text-center"><span>Resultados</span></h2>
                <div class="container">
                    <div class="row">
                    <p> 
                        Añadir explicación
                    </p>
                        <ul>
                            <li>
                                <p>Intro &rarr; Predicted popularity: [51.089655 - 67.222184]</p>
                            </li>
                            <li>
                                <p>Canalla &rarr; Predicted popularity: [54.423761 - 70.556289]</p>
                            </li>
                            <li>
                                <p>Payasos &rarr; Predicted popularity: [54.038490 - 70.171018]</p>
                            </li>
                            <li>
                                <p> La Demanda &rarr; Predicted popularity: [54.627449 - 70.759977]</p>
                            </li>
                            <li>
                                <p> Millonario &rarr; Predicted popularity: [54.384552 - 70.517080]</p>
                            </li>
                            <li>
                                <p> El Beso Que No Le Di &rarr; Predicted popularity: [54.904522 - 71.037050]</p>
                            </li>
                            <li>
                                <p> Ileso &rarr; Predicted popularity: [54.383425 - 70.515953]</p>
                            </li>
                            <li>
                                <p> Amor Enterrado &rarr; Predicted popularity: [54.552172 - 70.684700]</p>
                            </li>
                            <li>
                                <p>Me Quedo &rarr; Predicted popularity: [54.127291 - 70.259819]</p>
                            </li>
                            <li>
                                <p> Los ltimos &rarr; Predicted popularity: [54.070513 - 70.203041]</p>
                            </li>
                            <li>
                                <p> Aos Luz &rarr; Predicted popularity: [54.461848 - 70.594376]]</p>
                            </li>
                            <li>
                                <p> Los ltimos &rarr; Predicted popularity: [54.070513 - 70.203041]</p>
                            </li>
                            <li>
                                <p> Bellas (feat. Romeo Santos) &rarr; Predicted popularity: [54.411454 - 70.543982]</p>
                            </li>
                            <li>
                                <p> Inmortal &rarr; Predicted popularity: [54.013395 - 70.145923]</p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="first"></div>
                <div class="second"></div>
            </div>
        </div>

        <div class="performance" id="performance">
            <div class="small-container">
                <h2 class="text-center"><span>Rendimiento</span></h2>
                <div class="container">
                    <div class="row">
                        <p> 
                            El rendimiento está condicionado por factores externos como el número de álbumes y canciones que devuelve Spotipy o 
                            la latencia de comunicación con la API de Spotify. Es decir, la aplicación depdende de la velocidad con la que la API 
                            nos devuelve los nuevos lanzamientos. 
                        </p>
                        <p>
                            Las ejecuciones realizadas tanto el local como en AWS demuestran que la <span>conexión a la API de Spotify es un cuello de botella.</span>
                            La aplicación podría no escalar con la misma eficiencia con la que escala nuestra infraestructura.
                            El <span>escalado horizontal</span> de la aplicación, es decir, el aumentar el número de cores no provoca una mejora del rendimiento de la aplicación.
                        </p>
                        <p>   
                            El tiempo medio de análisis de 100 álbumes, es decir, aproximadamente unas 1000 canciones es de 2 minutos.
                        </p>
                    
                    </div>
                </div>
                <div class="first"></div>
                <div class="second"></div>
            </div>
        </div>
        
           

        <div class="about-us" id="about">
            <div class="small-container">
                <h2 class="text-center">¿Quienes  <span>somos?</span></h2>
                <p class="text-center">Somos un grupo de estudiantes de la facultad de informática de <span>Universidad Complutense de Madrid</span>.</p>
				<p class="text-center"> Estamos haciendo un proyecto para la asignatura de <span>Cloud & BigData</span></p>
                <div>
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-6 col-12 text-center">
                              <div class="item">
							   
                                    <img src="imgs/bego.jpg">
                                   <div>
                                    <h5 class="text">Begoña</h5>
									<p>Martinez </p>
									</div>
									
                                </div>
								
                                <div class="item">
                                    <img src="imgs/rehis.jpg">
                                    <div>
                                    <h5 class="text">David</h5>
									<p>Cantador </p>
							
									</div>
                                </div>
                                <div class="item">
                                    <img src="imgs/iago.jpg">
									<div>
                                    <h5 class="text">Iago</h5>
									<p>Zamorano </p>
									</div>
                                </div>
                                <div class="item">
                                    <img src="imgs/jose.jpg">
                                    <div>
                                    <h5 class="text">Jose</h5>
									<p>Jimenez </p> 
									
									</div>
                                </div>
                            </div>
                            <div class="col-lg-6 col-15 text-right">

                                <h4>GitHub</h4>
							
                                <p class="text-left"><a style="color:#00471d" href="https://github.com/iagger">Iago Zamorano Chouciño</a></p>
								
								<p class="text-left"><a style="color:#00471d" href="https://github.com/Rehis">David Cantador Piedras</a></p>
								
								<p class="text-left"><a style="color:#00471d" href="https://github.com/jotajjjj">José Jímenez Jiménez</a></p>
								
								<p class="text-left"><a style="color:#00471d" href="https://github.com/begomartinezmr">Begoña Martinez Martín</a></p>
								
								
								
                            </div>
                        </div>
                    </div>
                </div>
                <div class="first"></div>
                <div class="second"></div>
            </div>
        </div>
        
        <footer>
            <div class="container">
                    <div class="col-lg-3 col-md-6 col-12">
                        <div class="item">
                            <h4 class="text-uppercase">Citations</h4>
                            <ul>
                                <li><a href="#">About us</a></li>
                                <li><a href="#">Terms and conditions</a></li>
                                <li><a href="#">Privacy policy</a></li>
                                <li><a href="#">News</a></li>
                            </ul>
                        </div>
                    </div>


                </div>
            </div>
            <div class="copyright text-center">
                <p>Copyright 2021 Spotify Popularity Predictor</p>
            </div>
        </footer>
        
        <script src="js/jquery-3.3.1.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script>
            $(function () {
			
			
                
                'use strict';
                
                var winH = $(window).height();
                
                $('header').height(winH);  
                
                $('header .container > div').css('top', (winH / 2) - ( $('header .container > div').height() / 2));
                
                $('.navbar ul li a.search').on('click', function (e) {
                    e.preventDefault();
                });
                $('.navbar a.search').on('click', function () {
                    $('.navbar form').fadeToggle();
                });
                
                $('.navbar ul.navbar-nav li a').on('click', function (e) {
                    
                    var getAttr = $(this).attr('href');
                    
                    e.preventDefault();
                    $('html').animate({scrollTop: $(getAttr).offset().top}, 1000);
                });
            })
        </script>
    </body>
</html>